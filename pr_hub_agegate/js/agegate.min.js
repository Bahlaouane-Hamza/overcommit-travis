var country_id=null,search_input_field_value="";!function(a){Drupal.behaviors.prLandingPage={attach:function(b,c){function f(){window.ajaxLoader=!0;var b='<div id="loader-wrapper"><div id="loader"></div></div>';a("#wrapper-form-age-gate").append(b),a("#loader-wrapper").show()}function g(){var a=window.location.pathname.split("/"),b=a[1];if(b.indexOf("-")>-1){var d=b.split("-");"CN"==d[1].toUpperCase()&&(country_id=c.age_gate.iso[d[1].toUpperCase()],createCookie("cc","CN",31536e3,"/"))}else"ZH"==b.toUpperCase()&&(country_id=c.age_gate.iso.CN,createCookie("cc","CN",31536e3,"/"));j()}function j(){a("[name='age_gate[country]']").length>0&&null!==country_id&&(a("[name='age_gate[country]']").val(country_id),a("[name='age_gate[country]']").trigger("chosen:updated"))}function l(a,b){for(var c in b)if(this_val=b[c],this_val==a)return c}function m(){if("TRUE"==Cookies.get(c.menu_local.pr_referer)){var b="";if(c.menu_local.is_local_section){var d=Drupal.t("<p class='age-gate-small'>Youâ€™re being redirected to our "),e="<strong>"+c.menu_local.current_ls+"</strong>",f=Drupal.t(" section.</p><p class='age-gate-large'>Enjoy your visit !</p>");b=d+e+f}else b=c.menu_local.global_link_message;a(".progressbar__label").html(b),interstitiel.show(),Cookies.set(c.menu_local.pr_referer,"FALSE",{expires:30})}}function o(b,c){"undefined"==typeof c&&(c=""),b+="?time="+Math.floor(Date.now()/1e3),window.ajaxLoader=!1,a.ajax({url:b,type:"POST",data:{current_page_url:c},success:function(b){"false"==b?console.log("error"):(a(".body-marque-strategique").length?runMarque():a(".section-search-result").length&&(window.UISearch.reset(),window.UISearch.closeMenu(),window.UISearch.cleanUp(),window.UISearch.hideInputLayer(),a("#edit-search-api-views-fulltext").val(search_input_field_value),setTimeout(function(){window.UISearch.postprocess()},1300)),a(".front").length&&!n&&(o(Drupal.settings.session_link+"lp/"),n=!0)),window.ajaxLoader=!0}})}if(b==document){if(a(".no-agegate").length)return;setTimeout(function(){var b=a("#wrapper-form-age-gate"),c=b.addClass("ag-js-calc").outerHeight();b.removeClass("ag-js-calc"),a.keyframe.define([{name:"ageGateOpen","0%":{height:"0px"},"95%":{height:c+"px"},"100%":{height:"auto"}},{name:"ageGateOpenForm","0%":{height:"0px"},"95%":{height:c+"px"},"100%":{height:"auto"}}])},250),a(".age-gate-second-step").length&&a.pernodRicard.isMobile()&&(a(".age-gate-container").addClass("toggle-flex"),a("#abus-infos").appendTo("#wrapper-age-gate"));var d=a(".age-gate-first-step .age-gate-container #wrapper-form-age-gate .pr-hub-agegate-search-form .form-item-search .edit-search");if(d.data("defaultText")||(d.data("defaultText",d.attr("placeholder")),d.val(d.data("defaultText")),d.removeAttr("placeholder")),d.on("focus",function(){a(this).val()==a(this).data("defaultText")&&a(this).val("")}),d.on("blur",function(){""==a(this).val()&&a(this).val(a(this).data("defaultText"))}),a("body").on("focusin","input.edit-search",function(b){a("body").on("focusin","input.edit-search",function(b){a(".mobileAgeGateWrapper").addClass("lol")}),a("body").on("focusout","input.edit-search",function(b){a(".mobileAgeGateWrapper").removeClass("lol")})}),a.fn.scrollTest=function(){a(window).scrollTop(a(".l-main").scrollTop()+100)},a(".section-search-result").length&&(search_input_field_value=a("#edit-search-api-views-fulltext").val()),a(".age-gate-second-step , .age-gate-first-step").length&&(a("body, html").addClass("isAgeGate"),a(".l-main").addClass("fixWidth")),a(".front").length&&(a(".age-gate-first-step").length&&a("#block-pr-hub-agegate-pr-agegate-block").addClass("hideAgeGate"),a(".age-gate-second-step").length&&a("#block-pr-hub-agegate-pr-landing-page-block #pernod-ricard-interstitiel-age-gate").remove()),a(".age-gate-second-step").length&&a(".age-gate-second-step input").bind("input",function(){var b=a(this);b.hasClass("age-gate-birthday-year")||setTimeout(function(){b.val().length>=parseInt(b.attr("maxlength"),10)&&b.parents(".form-item").next().find("input").focus()},0)}),a(".age-gate-first-step").length&&(a(".age-gate-first-step .form-submit").wrap('<div class="form-submit-wrapper"></div>'),a(".age-gate-first-step .form-submit").val("")),interstitiel.init({timeout:1e3*c.age_gate.interstitiel_seconde,track_url:c.age_gate.track_url,cookie_lifetime:c.age_gate.cookie_lifetime}),a(".age-gate-second-step .form-submit").on("click",function(a){f()}),null==country_id){var h=function(b){window.ajaxLoader=!0,"undefined"!=typeof b.country&&"undefined"!=typeof b.country.iso_code?(createCookie("cc",b.country.iso_code,31536e3,"/"),"undefined"!=typeof c.age_gate.iso&&(country_id=c.age_gate.iso[b.country.iso_code],j())):g(),interstitiel.refreshHeadingMessage(function(b){c.menu_local.tracking_message=b.tracking_message,c.menu_local.global_link_message=b.global_link_message,c.menu_local.interstistiel_message=b.interstistiel_message,"TRUE"!=Cookies.get(c.menu_local.pr_referer)&&a(".progressbar__label").html(b.interstistiel_message)})},i=function(b){console.log("GEOIP ERROR: ",b),g(),window.ajaxLoader=!0,interstitiel.refreshHeadingMessage(function(b){c.menu_local.tracking_message=b.tracking_message,c.menu_local.global_link_message=b.global_link_message,c.menu_local.interstistiel_message=b.interstistiel_message,"TRUE"!=Cookies.get(c.menu_local.pr_referer)&&a(".progressbar__label").html(b.interstistiel_message)})};"undefined"!=typeof geoip2&&a(".pr-hub-agegate").length&&(window.ajaxLoader=!1,geoip2.country(h,i))}a.pernodRicard.whenMobileResize(function(){a(".age-gate-second-step ,.age-gate-first-step").removeClass("desktopAgeGateWrapper").addClass("mobileAgeGateWrapper")},function(){a(".age-gate-second-step ,.age-gate-first-step").removeClass("mobileAgeGateWrapper").addClass("desktopAgeGateWrapper")}),j(),a("#block-menu-landing-page-menu > .menu > li ").each(function(){var b=a(this).find("a"),c=b.text();b.empty().append("<span>"+c+"</span>")});var k=a(".remember_me_txt2").text();a(".remember_me_txt2").remove(),a(".form-item-age-gate-save-me").append('<br><span class="remember_me_txt2">'+k+"</span>"),a(".edit-age-gate-birthday .form-item input ").each(function(){}),a("#targetAgeGateWrapperId .menu a").addClass("landing-page-link"),a(".lp-link-home").on("click",function(){return a(".age-gate-first-step").remove(),a(".age-gate-second-step").length?(a("#block-pr-hub-agegate-pr-agegate-block").fadeIn().removeClass("hideAgeGate"),a("#block-pr-hub-agegate-pr-landing-page-block").fadeOut()):(a(".l-page-age-gate").removeClass("testAgeGatePage"),a("body, html").removeClass("isAgeGate"),a(".l-main").removeClass("fixWidth"),o(Drupal.settings.session_link+"lp"),setTimeout(function(){"TRUE"==Cookies.get(c.menu_local.pr_referer)?m():interstitiel.show(),interstitiel.saveCookie()},100)),!1}),a("#edit-age-gate-country").change(function(){createCookie("cc",l(a("#edit-age-gate-country").val(),c.age_gate.iso),31536e3,"/"),interstitiel.refreshHeadingMessage(function(b){c.menu_local.tracking_message=b.tracking_message,c.menu_local.global_link_message=b.global_link_message,c.menu_local.interstistiel_message=b.interstistiel_message,"TRUE"!=Cookies.get(c.menu_local.pr_referer)&&a(".progressbar__label").html(b.interstistiel_message)})}),a(".age-gate-second-step ,.age-gate-first-step").length&&(a.pernodRicard.isMobile()?a(".age-gate-second-step ,.age-gate-first-step").addClass("mobileAgeGateWrapper"):a(".age-gate-second-step ,.age-gate-first-step").addClass("desktopAgeGateWrapper")),a("a.landing-page-link").not(".lp-link-home").click(function(){Cookies.set("passed_landing_page","TRUE",{expires:30})}),setTimeout(function(){a(".age-gate-container").addClass("toggle-flex"),a("#wrapper-form-age-gate").addClass("open"),a("#pernod-age-gate-title").addClass("fixThis"),a.pernodRicard.isMobile()&&(a("#abus-infos").appendTo("#wrapper-age-gate"),a("#pernod-age-gate-title").remove())},a(".age-gate-second-step").length?500:4e3)}a.fn.search_set_cookie=function(){createCookie("pr_landing_page_save_me","true",Drupal.settings.cookie_lifetime,"/")},a.fn.agegate_set_cookie=function(){createCookie("pr_age_gate_save_me","true",Drupal.settings.cookie_lifetime,"/")},a.fn.agegate_update_country_cookie=function(a){createCookie("cc",a,Drupal.settings.cookie_lifetime,"/")},a.fn.show_interstitiel=function(){interstitiel.show(),interstitiel.saveCookie()},a.fn.show_redirect_interstitiel=function(){m()};var n=!1;a.fn.agegate_set_session=function(a,b){o(a,b)},a.fn.refresh_interstitiel=function(){interstitiel.refreshHeadingMessage(function(a){c.menu_local.tracking_message=a.tracking_message,c.menu_local.global_link_message=a.global_link_message,c.menu_local.interstistiel_message=a.interstistiel_message})}}}}(jQuery);